#!/bin/sh

printf "/*\n    Auto-generated by gensym." > _symbols.gen
printf "    DO NOT EDIT\n*/\n\n#include \"symbols.h\"\n#include <stdint.h>\n" >> _symbols.gen
printf "const symbol_t _kernel_symtab[] = {" >> _symbols.gen
nm $1 | grep " T " | awk '{ print "    { .addr = 0x"$1", .name = \""$3"\" }," }' | sort >> _symbols.gen
printf "    { .addr = UINT64_MAX, .name = \"\" }\n};" >> _symbols.gen
