#!/bin/sh

echo "/*\n\tAuto-generated by gensym\n\tDO NOT EDIT\n*/\n#include \"symbols.h\"\n\nsymbol_t _kernel_symtab[]={" > symbols.c
nm $1 | grep " T " | awk '{ print "    { .addr = 0x"$1", .name = \""$3"\" }," }' | sort >> symbols.c
echo "\t{ .addr = 0xffffffffffffffff, .name = \"\" }\n};" >> symbols.c
